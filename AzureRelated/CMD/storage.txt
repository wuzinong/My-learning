//Quickstart: Upload, download, and list blobs with PowerShell

1. Sign in to Azure

Connect-AzAccount

//Geo location

Get-AzLocation | select Location 
$location = "eastus"


2. Create a resource group

$resourceGroup = "myResourceGroup"
New-AzResourceGroup -Name $resourceGroup -Location $location


3. Create a storage account

$storageAccount = New-AzStorageAccount -ResourceGroupName $resourceGroup `
    -Name "mystorageaccount" `
    -SkuName Standard_LRS `
    -Location $location `

$ctx = $storageAccount.Context


4. Create a container

$containerName = "quickstartblobs"
New-AzStorageContainer -Name $containerName -Context $ctx -Permission blobs


5. Upload blobls to the container

# upload a file 
Set-AzStorageBlobContent -File "D:\_TestImages\Image001.jpg" `
    -Container $containerName `
    -Blob "Image001.jpg" `
    -Context $ctx

# upload another file
Set-AzStorageBlobContent -File "D:\_TestImages\Image002.pn" `
    -Container $containerName `
    -Blob "Image002.png" `
    -Context $ctx

# upload a file to a folder
Set-AzStorageBlobContent -File "D:\_TestImages\foldername\Image003.jpg" `
    -Container $containerName `
    -Blob "Fildername/Image003.jpg" `
    -Context $ctx


6. List the blobs in a container
Get-AzStorageBlob -Container $containerName -Context $ctx | select Name


7. Download blobs
# download first blobl

Get-AzStorageBlobContent -Blob "Image001.jpg" `
    -Container $containerName `
    -Destination "D:\_TestImages\Downloads\" `
    -Context $ctx

# download another blob

Get-AzStorageBlob -Blob "Image001.jpg" `
    -Container $containerName `
    -Destination "D:\_TestImages\Downloads\" `
    -Context $ctx


8.Data trans fer with AzCopy

azcopy login
azcopy copy 'C:\mydirectory\myfile.txt' 'https://mystorageaccount.blob.core.windows/myfile.txt'


9.Clean up resources

Remove-AzResourceGroup -Name $resourceGroup