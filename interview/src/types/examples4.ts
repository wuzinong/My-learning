type Board = any[][];

//Utils
type ArrayToUnion<T extends string[]> = T[number];

type FillArray<
  T,
  N extends number,
  A extends any[] = []
> = A['length'] extends N ? A : FillArray<T, N, [T, ...A]>;

type Flatten<T extends any[] = []> = T extends [infer Head, ...infer Tail]
  ? Head extends any[]
    ? [...Flatten<Head>, ...Flatten<Tail>]
    : [Head, ...Flatten<Tail>]
  : [];

type FlattenRows<T extends any[][]> = { [I in keyof T]: Flatten<T[I]> };

type TraverseCols<T extends Array<Array<string>>, ColIndex extends number> = {
  [I in keyof T]: ColIndex extends keyof T[I] ? T[I][ColIndex] : never;
};

type TakeSegment<
  T extends string[][][],
  RowIndex extends number[] = [],
  ColIndex extends number = 0,
  Count extends number = 3,
  Res extends string[][] = []
> = Res['length'] extends Count
  ? Flatten<Res>
  : TakeSegment<
      T,
      [...RowIndex, 1],
      ColIndex,
      Count,
      [...Res, T[RowIndex['length']][ColIndex]]
    >;

type TraverseSegments<
  T extends string[][][],
  RowIndex extends number[] = [],
  ColIndex extends number[] = [],
  R extends string[][] = []
> = R['length'] extends T['length']
  ? R
  : TraverseSegments<
      T,
      ColIndex['length'] extends 2
        ? [...RowIndex, ...FillArray<1, 3>]
        : RowIndex,
      ColIndex['length'] extends 2 ? [] : [...ColIndex, 1],
      [...R, TakeSegment<T, RowIndex, ColIndex['length']>]
    >;

// Validations
type AllValid = '111';

type ValidateH<T extends Board, R extends number = 1> = R extends 0
  ? R
  : T extends [infer Head, ...infer Tail]
  ? Reindeer extends (string[] & Head)[number]
    ? Tail extends Board
      ? ValidateH<Tail, 1>
      : 0
    : 0
  : R;

type ValidateSeg<T extends Board> = ValidateH<TraverseSegments<T>>;

type ValidateV<
  T extends Board,
  Counter extends any[] = []
> = Counter['length'] extends T['length']
  ? 1
  : Reindeer extends TraverseCols<T, Counter['length']>[number]
  ? ValidateV<T, [...Counter, 1]>
  : 0;

type Validate<T extends Board> = `${ValidateH<FlattenRows<T>>}${ValidateV<
  FlattenRows<T>
>}${ValidateSeg<T>}` extends AllValid
  ? true
  : false;
type test_sudoku_1_actual = Validate<
  [
    //   ^?
    [['ðŸ’¨', 'ðŸ’ƒ', 'ðŸ¦Œ'], ['â˜„ï¸', 'â¤ï¸', 'ðŸŒ©ï¸'], ['ðŸŒŸ', 'âš¡', 'ðŸ”´']],
    [['ðŸŒŸ', 'âš¡', 'ðŸ”´'], ['ðŸ’¨', 'ðŸ’ƒ', 'ðŸ¦Œ'], ['â˜„ï¸', 'â¤ï¸', 'ðŸŒ©ï¸']],
    [['â˜„ï¸', 'â¤ï¸', 'ðŸŒ©ï¸'], ['ðŸŒŸ', 'âš¡', 'ðŸ”´'], ['ðŸ’¨', 'ðŸ’ƒ', 'ðŸ¦Œ']],
    [['ðŸ¦Œ', 'ðŸ’¨', 'ðŸ’ƒ'], ['âš¡', 'â˜„ï¸', 'â¤ï¸'], ['ðŸ”´', 'ðŸŒ©ï¸', 'ðŸŒŸ']],
    [['ðŸŒ©ï¸', 'ðŸ”´', 'ðŸŒŸ'], ['ðŸ¦Œ', 'ðŸ’¨', 'ðŸ’ƒ'], ['âš¡', 'â˜„ï¸', 'â¤ï¸']],
    [['âš¡', 'â˜„ï¸', 'â¤ï¸'], ['ðŸŒ©ï¸', 'ðŸ”´', 'ðŸŒŸ'], ['ðŸ¦Œ', 'ðŸ’¨', 'ðŸ’ƒ']],
    [['ðŸ’ƒ', 'ðŸ¦Œ', 'ðŸ’¨'], ['â¤ï¸', 'ðŸŒŸ', 'â˜„ï¸'], ['ðŸŒ©ï¸', 'ðŸ”´', 'âš¡']],
    [['ðŸ”´', 'ðŸŒ©ï¸', 'âš¡'], ['ðŸ’ƒ', 'ðŸ¦Œ', 'ðŸ’¨'], ['â¤ï¸', 'ðŸŒŸ', 'â˜„ï¸']],
    [['â¤ï¸', 'ðŸŒŸ', 'â˜„ï¸'], ['ðŸ”´', 'ðŸŒ©ï¸', 'âš¡'], ['ðŸ’ƒ', 'ðŸ¦Œ', 'ðŸ’¨']]
  ]
>;
type test_sudoku_1 = Expect<Equal<test_sudoku_1_actual, true>>;

type test_sudoku_2_actual = Validate<
  [
    //   ^?
    [['ðŸŒ©ï¸', 'ðŸ’¨', 'â˜„ï¸'], ['ðŸŒŸ', 'ðŸ¦Œ', 'âš¡'], ['â¤ï¸', 'ðŸ”´', 'ðŸ’ƒ']],
    [['ðŸŒŸ', 'âš¡', 'â¤ï¸'], ['ðŸ”´', 'ðŸ’ƒ', 'â˜„ï¸'], ['ðŸŒ©ï¸', 'ðŸ’¨', 'ðŸ¦Œ']],
    [['ðŸ”´', 'ðŸ¦Œ', 'ðŸ’ƒ'], ['ðŸ’¨', 'â¤ï¸', 'ðŸŒ©ï¸'], ['ðŸŒŸ', 'âš¡', 'â˜„ï¸']],
    [['â¤ï¸', 'â˜„ï¸', 'ðŸŒ©ï¸'], ['ðŸ’ƒ', 'âš¡', 'ðŸ”´'], ['ðŸ’¨', 'ðŸ¦Œ', 'ðŸŒŸ']],
    [['ðŸ¦Œ', 'ðŸ’ƒ', 'âš¡'], ['ðŸŒ©ï¸', 'ðŸŒŸ', 'ðŸ’¨'], ['ðŸ”´', 'â˜„ï¸', 'â¤ï¸']],
    [['ðŸ’¨', 'ðŸŒŸ', 'ðŸ”´'], ['ðŸ¦Œ', 'â˜„ï¸', 'â¤ï¸'], ['âš¡', 'ðŸ’ƒ', 'ðŸŒ©ï¸']],
    [['â˜„ï¸', 'ðŸ”´', 'ðŸ’¨'], ['â¤ï¸', 'ðŸŒ©ï¸', 'ðŸ¦Œ'], ['ðŸ’ƒ', 'ðŸŒŸ', 'âš¡']],
    [['ðŸ’ƒ', 'â¤ï¸', 'ðŸ¦Œ'], ['âš¡', 'ðŸ”´', 'ðŸŒŸ'], ['â˜„ï¸', 'ðŸŒ©ï¸', 'ðŸ’¨']],
    [['âš¡', 'ðŸŒ©ï¸', 'ðŸŒŸ'], ['â˜„ï¸', 'ðŸ’¨', 'ðŸ’ƒ'], ['ðŸ¦Œ', 'â¤ï¸', 'ðŸ”´']]
  ]
>;
type test_sudoku_2 = Expect<Equal<test_sudoku_2_actual, true>>;

type test_sudoku_3_actual = Validate<
  [
    //   ^?
    [['ðŸ¦Œ', 'ðŸ”´', 'ðŸ’ƒ'], ['ðŸŒ©ï¸', 'â˜„ï¸', 'ðŸ’¨'], ['âš¡', 'â¤ï¸', 'ðŸŒŸ']],
    [['ðŸŒŸ', 'âš¡', 'ðŸ’¨'], ['â¤ï¸', 'ðŸ’ƒ', 'ðŸ”´'], ['â˜„ï¸', 'ðŸŒ©ï¸', 'ðŸ¦Œ']],
    [['â˜„ï¸', 'ðŸŒ©ï¸', 'â¤ï¸'], ['âš¡', 'ðŸŒŸ', 'ðŸ¦Œ'], ['ðŸ’ƒ', 'ðŸ”´', 'ðŸ’¨']],
    [['ðŸŒ©ï¸', 'ðŸ’ƒ', 'ðŸ”´'], ['ðŸ¦Œ', 'ðŸ’¨', 'âš¡'], ['ðŸŒŸ', 'â˜„ï¸', 'â¤ï¸']],
    [['â¤ï¸', 'â˜„ï¸', 'âš¡'], ['ðŸ’ƒ', 'ðŸŒ©ï¸', 'ðŸŒŸ'], ['ðŸ¦Œ', 'ðŸ’¨', 'ðŸ”´']],
    [['ðŸ’¨', 'ðŸŒŸ', 'ðŸ¦Œ'], ['â˜„ï¸', 'ðŸ”´', 'â¤ï¸'], ['ðŸŒ©ï¸', 'ðŸ’ƒ', 'âš¡']],
    [['ðŸ’ƒ', 'ðŸ’¨', 'ðŸŒŸ'], ['ðŸ”´', 'ðŸ¦Œ', 'â˜„ï¸'], ['â¤ï¸', 'âš¡', 'ðŸŒ©ï¸']],
    [['ðŸ”´', 'â¤ï¸', 'â˜„ï¸'], ['ðŸŒŸ', 'âš¡', 'ðŸŒ©ï¸'], ['ðŸ’¨', 'ðŸ¦Œ', 'ðŸ’ƒ']],
    [['âš¡', 'ðŸ¦Œ', 'ðŸŒ©ï¸'], ['ðŸ’¨', 'â¤ï¸', 'ðŸ’ƒ'], ['ðŸ”´', 'ðŸŒŸ', 'â˜„ï¸']]
  ]
>;
type test_sudoku_3 = Expect<Equal<test_sudoku_3_actual, true>>;

type test_sudoku_4_actual = Validate<
  [
    //   ^?
    [['ðŸ’¨', 'ðŸ’ƒ', 'ðŸ¦Œ'], ['â˜„ï¸', 'â¤ï¸', 'ðŸŒ©ï¸'], ['ðŸŒŸ', 'âš¡', 'ðŸ”´']],
    [['ðŸŒŸ', 'âš¡', 'ðŸ”´'], ['ðŸ’¨', 'ðŸ’ƒ', 'ðŸ¦Œ'], ['â˜„ï¸', 'â¤ï¸', 'ðŸŒ©ï¸']],
    [['â˜„ï¸', 'â¤ï¸', 'ðŸŒ©ï¸'], ['ðŸŒŸ', 'âš¡', 'ðŸ”´'], ['ðŸ’¨', 'ðŸ’ƒ', 'ðŸ¦Œ']],
    [['ðŸ¦Œ', 'ðŸ’¨', 'ðŸ’ƒ'], ['âš¡', 'â˜„ï¸', 'â¤ï¸'], ['ðŸ”´', 'ðŸŒ©ï¸', 'ðŸŒŸ']],
    [['ðŸŒ©ï¸', 'ðŸ”´', 'ðŸŒŸ'], ['ðŸ¦Œ', 'ðŸ’¨', 'ðŸ’ƒ'], ['âš¡', 'â˜„ï¸', 'â¤ï¸']],
    [['âš¡', 'â˜„ï¸', 'â¤ï¸'], ['ðŸŒ©ï¸', 'ðŸ”´', 'ðŸŒŸ'], ['ðŸ¦Œ', 'ðŸ’¨', 'ðŸ’ƒ']],
    [['ðŸ’ƒ', 'ðŸ¦Œ', 'ðŸ’¨'], ['â¤ï¸', 'ðŸŒŸ', 'â˜„ï¸'], ['âš¡', 'ðŸ”´', 'ðŸŒŸ']],
    [['ðŸ”´', 'ðŸŒ©ï¸', 'âš¡'], ['ðŸ’ƒ', 'ðŸ¦Œ', 'ðŸ’¨'], ['â¤ï¸', 'ðŸŒŸ', 'â˜„ï¸']],
    [['â¤ï¸', 'ðŸŒŸ', 'â˜„ï¸'], ['ðŸ”´', 'ðŸŒ©ï¸', 'âš¡'], ['ðŸ’ƒ', 'ðŸ¦Œ', 'ðŸ’¨']]
  ]
>;
type test_sudoku_4 = Expect<Equal<test_sudoku_4_actual, false>>;

type test_sudoku_5_actual = Validate<
  [
    //   ^?
    [['ðŸŒ©ï¸', 'ðŸ’¨', 'â˜„ï¸'], ['ðŸŒŸ', 'ðŸ¦Œ', 'âš¡'], ['â¤ï¸', 'ðŸ”´', 'ðŸ’ƒ']],
    [['ðŸŒŸ', 'âš¡', 'â¤ï¸'], ['ðŸ”´', 'ðŸ’ƒ', 'â˜„ï¸'], ['ðŸŒ©ï¸', 'ðŸ’¨', 'ðŸ¦Œ']],
    [['ðŸ”´', 'ðŸ¦Œ', 'ðŸ’ƒ'], ['ðŸ’¨', 'â¤ï¸', 'ðŸŒ©ï¸'], ['ðŸŒŸ', 'âš¡', 'â˜„ï¸']],
    [['â¤ï¸', 'â˜„ï¸', 'ðŸŒ©ï¸'], ['ðŸ’ƒ', 'âš¡', 'ðŸ”´'], ['ðŸ’¨', 'ðŸ¦Œ', 'ðŸŒŸ']],
    [['ðŸ¦Œ', 'ðŸ’ƒ', 'âš¡'], ['ðŸŒ©ï¸', 'ðŸŒŸ', 'ðŸ’¨'], ['ðŸ”´', 'â˜„ï¸', 'â¤ï¸']],
    [['ðŸ’¨', 'ðŸŒŸ', 'ðŸ”´'], ['ðŸ¦Œ', 'â˜„ï¸', 'â¤ï¸'], ['âš¡', 'ðŸ’ƒ', 'ðŸŒ©ï¸']],
    [['â˜„ï¸', 'ðŸ”´', 'ðŸ’¨'], ['â¤ï¸', 'ðŸ’ƒ', 'ðŸ¦Œ'], ['ðŸ’ƒ', 'ðŸŒŸ', 'âš¡']],
    [['ðŸ’ƒ', 'â¤ï¸', 'ðŸ¦Œ'], ['âš¡', 'ðŸ”´', 'ðŸŒŸ'], ['â˜„ï¸', 'ðŸŒ©ï¸', 'ðŸ’¨']],
    [['âš¡', 'ðŸŒ©ï¸', 'ðŸŒŸ'], ['â˜„ï¸', 'ðŸ’¨', 'ðŸ’ƒ'], ['ðŸ¦Œ', 'â¤ï¸', 'ðŸ”´']]
  ]
>;
type test_sudoku_5 = Expect<Equal<test_sudoku_5_actual, false>>;

type test_sudoku_6_actual = Validate<
  [
    //   ^?
    [['âš¡', 'ðŸ”´', 'ðŸŒ©ï¸'], ['ðŸ¦Œ', 'â¤ï¸', 'ðŸ’¨'], ['ðŸ’¨', 'ðŸŒŸ', 'â˜„ï¸']],
    [['â¤ï¸', 'ðŸ¦Œ', 'ðŸŒŸ'], ['ðŸ’¨', 'ðŸŒŸ', 'ðŸ”´'], ['ðŸ’ƒ', 'âš¡', 'ðŸŒ©ï¸']],
    [['ðŸ’¨', 'ðŸ’ƒ', 'ðŸŒŸ'], ['â˜„ï¸', 'âš¡', 'ðŸŒ©ï¸'], ['ðŸ”´', 'â¤ï¸', 'ðŸ¦Œ']],
    [['ðŸ¦Œ', 'âš¡', 'ðŸ”´'], ['â¤ï¸', 'ðŸ’ƒ', 'ðŸ’¨'], ['â˜„ï¸', 'ðŸŒ©ï¸', 'ðŸŒŸ']],
    [['ðŸŒŸ', 'ðŸŒ©ï¸', 'ðŸ’ƒ'], ['âš¡', 'ðŸ”´', 'â˜„ï¸'], ['â¤ï¸', 'ðŸ¦Œ', 'ðŸ’¨']],
    [['â˜„ï¸', 'ðŸ’¨', 'â¤ï¸'], ['ðŸŒŸ', 'ðŸŒ©ï¸', 'ðŸ¦Œ'], ['âš¡', 'ðŸ’ƒ', 'ðŸ”´']],
    [['ðŸŒ©ï¸', 'â˜„ï¸', 'ðŸ’¨'], ['ðŸ’ƒ', 'ðŸ¦Œ', 'âš¡'], ['ðŸŒŸ', 'ðŸ”´', 'â¤ï¸']],
    [['ðŸ”´', 'â¤ï¸', 'âš¡'], ['ðŸŒ©ï¸', 'â˜„ï¸', 'ðŸŒŸ'], ['ðŸ¦Œ', 'ðŸ’¨', 'ðŸ’ƒ']],
    [['ðŸ’ƒ', 'ðŸŒŸ', 'ðŸ¦Œ'], ['ðŸ”´', 'ðŸ’¨', 'â¤ï¸'], ['ðŸŒ©ï¸', 'â˜„ï¸', 'âš¡']]
  ]
>;
type test_sudoku_6 = Expect<Equal<test_sudoku_6_actual, false>>;

type test_sudoku_7_actual = Validate<
  [
    [['ðŸ’¨', 'ðŸ’ƒ', 'ðŸ¦Œ'], ['â˜„ï¸', 'â¤ï¸', 'ðŸŒ©ï¸'], ['ðŸŒŸ', 'âš¡', 'ðŸ”´']],
    [['ðŸ’ƒ', 'ðŸ¦Œ', 'â˜„ï¸'], ['â¤ï¸', 'ðŸŒ©ï¸', 'ðŸŒŸ'], ['âš¡', 'ðŸ”´', 'ðŸ’¨']],
    [['ðŸ¦Œ', 'â˜„ï¸', 'â¤ï¸'], ['ðŸŒ©ï¸', 'ðŸŒŸ', 'âš¡'], ['ðŸ”´', 'ðŸ’¨', 'ðŸ’ƒ']],
    [['â˜„ï¸', 'â¤ï¸', 'ðŸŒ©ï¸'], ['ðŸŒŸ', 'âš¡', 'ðŸ”´'], ['ðŸ’¨', 'ðŸ’ƒ', 'ðŸ¦Œ']],
    [['â¤ï¸', 'ðŸŒ©ï¸', 'ðŸŒŸ'], ['âš¡', 'ðŸ”´', 'ðŸ’¨'], ['ðŸ’ƒ', 'ðŸ¦Œ', 'â˜„ï¸']],
    [['ðŸŒ©ï¸', 'ðŸŒŸ', 'âš¡'], ['ðŸ”´', 'ðŸ’¨', 'ðŸ’ƒ'], ['ðŸ¦Œ', 'â˜„ï¸', 'â¤ï¸']],
    [['ðŸŒŸ', 'âš¡', 'ðŸ”´'], ['ðŸ’¨', 'ðŸ’ƒ', 'ðŸ¦Œ'], ['â˜„ï¸', 'â¤ï¸', 'ðŸŒ©ï¸']],
    [['âš¡', 'ðŸ”´', 'ðŸ’¨'], ['ðŸ’ƒ', 'ðŸ¦Œ', 'â˜„ï¸'], ['â¤ï¸', 'ðŸŒ©ï¸', 'ðŸŒŸ']],
    [['ðŸ”´', 'ðŸ’¨', 'ðŸ’ƒ'], ['ðŸ¦Œ', 'â˜„ï¸', 'â¤ï¸'], ['ðŸŒ©ï¸', 'ðŸŒŸ', 'âš¡']]
  ]
>;

type test_sudoku_7 = Expect<Equal<test_sudoku_7_actual, false>>;

type test_sudoku_8_actual = Validate<
  [
    //   ^?
    [['ðŸ¦Œ', 'ðŸ”´', 'ðŸ’ƒ'], ['ðŸŒ©ï¸', 'â˜„ï¸', 'ðŸ’¨'], ['âš¡', 'â¤ï¸', 'ðŸŒŸ']],
    [['ðŸ¦Œ', 'ðŸ”´', 'ðŸ’ƒ'], ['ðŸŒ©ï¸', 'â˜„ï¸', 'ðŸ’¨'], ['âš¡', 'â¤ï¸', 'ðŸŒŸ']],
    [['ðŸ¦Œ', 'ðŸ”´', 'ðŸ’ƒ'], ['ðŸŒ©ï¸', 'â˜„ï¸', 'ðŸ’¨'], ['âš¡', 'â¤ï¸', 'ðŸŒŸ']],
    [['ðŸ¦Œ', 'ðŸ”´', 'ðŸ’ƒ'], ['ðŸŒ©ï¸', 'â˜„ï¸', 'ðŸ’¨'], ['âš¡', 'â¤ï¸', 'ðŸŒŸ']],
    [['ðŸ¦Œ', 'ðŸ”´', 'ðŸ’ƒ'], ['ðŸŒ©ï¸', 'â˜„ï¸', 'ðŸ’¨'], ['âš¡', 'â¤ï¸', 'ðŸŒŸ']],
    [['ðŸ¦Œ', 'ðŸ”´', 'ðŸ’ƒ'], ['ðŸŒ©ï¸', 'â˜„ï¸', 'ðŸ’¨'], ['âš¡', 'â¤ï¸', 'ðŸŒŸ']],
    [['ðŸ¦Œ', 'ðŸ”´', 'ðŸ’ƒ'], ['ðŸŒ©ï¸', 'â˜„ï¸', 'ðŸ’¨'], ['âš¡', 'â¤ï¸', 'ðŸŒŸ']],
    [['ðŸ¦Œ', 'ðŸ”´', 'ðŸ’ƒ'], ['ðŸŒ©ï¸', 'â˜„ï¸', 'ðŸ’¨'], ['âš¡', 'â¤ï¸', 'ðŸŒŸ']],
    [['ðŸ¦Œ', 'ðŸ”´', 'ðŸ’ƒ'], ['ðŸŒ©ï¸', 'â˜„ï¸', 'ðŸ’¨'], ['âš¡', 'â¤ï¸', 'ðŸŒŸ']]
  ]
>;

type test_sudoku_8 = Expect<Equal<test_sudoku_8_actual, false>>;
